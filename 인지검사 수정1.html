<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê¸¸ìŒí•œì˜ì› ì¸ì§€ ê±´ê°• ìŠ¤í¬ë¦¬ë‹</title>
    <style>
        /* ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
        body { font-family: 'Malgun Gothic', 'ë§‘ì€ ê³ ë”•', sans-serif; background-color: #f8f9fa; color: #333; line-height: 1.6; margin: 0; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; background-color: #ffffff; padding: 30px; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        h1, h2 { text-align: center; color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 10px; margin-bottom: 30px; }
        .section { margin-bottom: 35px; }
        .section-title { font-size: 1.4em; font-weight: bold; color: #3498db; margin-bottom: 15px; }
        .question { margin-bottom: 20px; }
        .question p { font-size: 1.1em; margin: 0 0 10px 0; }
        .input-group { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 10px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        label .required { color: #e74c3c; font-weight: bold; margin-left: 4px; }
        input[type="text"], input[type="date"], input[type="number"], select { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; }
        .radio-group label, .checkbox-group label { font-weight: normal; }
        #bmi-result { font-weight: bold; color: #e74c3c; margin-left: 10px; }
        .button-container { text-align: center; margin-top: 40px; }
        button { background-color: #3498db; color: white; padding: 15px 30px; border: none; border-radius: 5px; font-size: 1.2em; cursor: pointer; }
        #result-page { display: none; }
        
        /* ê²°ê³¼ì§€ ìŠ¤íƒ€ì¼ */
        .result-header { text-align: center; margin-bottom: 30px; }
        .result-header h1 { font-size: 2em; color: #3498db; border: none;}
        .patient-info { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; border: 1px solid #eee; padding: 15px; margin-bottom: 30px; border-radius: 5px; text-align: center; font-size: 1.1em; }
        .result-box { padding: 25px; margin: 20px 0; border-radius: 8px; text-align: center; }
        .result-box.level-1 { background-color: #e8f5e9; border: 2px solid #4caf50; }
        .result-box.level-2 { background-color: #fffde7; border: 2px solid #ffc107; }
        .result-box.level-3 { background-color: #ffebee; border: 2px solid #f44336; }
        .result-box .result-title { font-size: 2.2em; font-weight: bold; margin: 0; }
        .result-box .result-subtitle { font-size: 1.2em; margin: 5px 0 0 0;}
        .result-section { margin-top: 30px; }
        .result-section h3 { font-size: 1.3em; color: #3498db; border-bottom: 1px solid #eee; padding-bottom: 8px;}
        .result-section ul { list-style-type: 'âœ“ '; padding-left: 20px;}
        .result-section li { margin-bottom: 8px; }
        .practitioner-comment { margin-top: 40px; padding: 15px; border: 1px dashed #ccc; border-radius: 5px; }
        .practitioner-comment h3 { margin-top: 0;}

        /* ì¸ì‡„ ìŠ¤íƒ€ì¼ */
        @media print {
            body { background-color: white; padding: 0; }
            #cognitive-form, .no-print { display: none !important; }
            #result-page { display: block !important; box-shadow: none; border: none; padding: 0; margin: 0; }
            .container { padding: 0; box-shadow: none; border-radius: 0; }
        }
    </style>
</head>
<body>

    <div class="container">
        <form id="cognitive-form">
            <h1>ì–´ë¥´ì‹  ì¸ì§€ ê±´ê°• ìŠ¤í¬ë¦¬ë‹</h1>
            <div class="section">
                <h2 class="section-title">1. ê¸°ë³¸ ì •ë³´</h2>
                 <div class="input-group">
                    <div>
                        <label for="name">ì„±í•¨<span class="required">*</span></label>
                        <input type="text" id="name" name="name">
                    </div>
                    <div>
                        <label for="birthdate">ìƒë…„ì›”ì¼<span class="required">*</span></label>
                        <input type="date" id="birthdate" name="birthdate">
                    </div>
                </div>
                <div class="input-group">
                     <div>
                        <label for="gender">ì„±ë³„<span class="required">*</span></label>
                        <select id="gender" name="gender">
                            <option value="">ì„ íƒ</option>
                            <option value="male">ë‚¨</option>
                            <option value="female">ì—¬</option>
                        </select>
                    </div>
                    <div>
                        <label for="today">ê²€ì‚¬ ë‚ ì§œ</label>
                        <input type="date" id="today" name="today">
                    </div>
                </div>
            </div>
            
            <div class="section">
                 <h2 class="section-title">2. ì¸ì§€ ê¸°ëŠ¥ í‰ê°€</h2>
                 <div class="question"><p>1. ìµœê·¼ ê¸°ì–µë ¥ì´ ì˜ˆì „ ê°™ì§€ ì•Šë‹¤ê³  ëŠë¼ì‹­ë‹ˆê¹Œ?<span class="required">*</span></p> <div class="radio-group"><label><input type="radio" name="q1" value="1">ì „í˜€</label> <label><input type="radio" name="q1" value="2">ê°€ë”</label> <label><input type="radio" name="q1" value="3">ìì£¼</label> <label><input type="radio" name="q1" value="4">í•­ìƒ</label></div></div>
                 <div class="question"><p>2. ë©°ì¹  ì „ ëŒ€í™”ë‚˜ ì•½ì†ì„ ìŠì–´ë²„ë¦½ë‹ˆê¹Œ?<span class="required">*</span></p> <div class="radio-group"><label><input type="radio" name="q2" value="1">ì „í˜€</label> <label><input type="radio" name="q2" value="2">ê°€ë”</label> <label><input type="radio" name="q2" value="3">ìì£¼</label> <label><input type="radio" name="q2" value="4">í•­ìƒ</label></div></div>
                 <div class="question"><p>3. ë¬¼ê±´ ë‘” ê³³ì„ ëª°ë¼ í•œì°¸ ì°¾ìŠµë‹ˆê¹Œ?<span class="required">*</span></p> <div class="radio-group"><label><input type="radio" name="q3" value="1">ê±°ì˜</label> <label><input type="radio" name="q3" value="2">ê°€ë”</label> <label><input type="radio" name="q3" value="3">ìì£¼</label> <label><input type="radio" name="q3" value="4">ë§¤ìš° ìì£¼</label></div></div>
                 <div class="question"><p>4. ëŒ€í™” ì¤‘ ë‹¨ì–´ê°€ ì˜ ì•ˆ ë– ì˜¤ë¦…ë‹ˆê¹Œ?<span class="required">*</span></p> <div class="radio-group"><label><input type="radio" name="q4" value="1">ê±°ì˜</label> <label><input type="radio" name="q4" value="2">ê°€ë”</label> <label><input type="radio" name="q4" value="3">ìì£¼</label> <label><input type="radio" name="q4" value="4">ë§¤ìš° ìì£¼</label></div></div>
            </div>
            
            <div class="section"><h2 class="section-title">3. ìˆ˜ë©´ ë° ìƒí™œ ìŠµê´€</h2>
                <div class="question"><p>5. ì ë“œëŠ” ë° ë³´í†µ ì–¼ë§ˆë‚˜ ê±¸ë¦¬ì‹­ë‹ˆê¹Œ?</p><div class="radio-group"><label><input type="radio" name="q5" value="1">15ë¶„ ì´ë‚´</label><label><input type="radio" name="q5" value="2">~30ë¶„</label><label><input type="radio" name="q5" value="3">~1ì‹œê°„</label><label><input type="radio" name="q5" value="4">1ì‹œê°„ ì´ìƒ</label></div></div>
                <div class="question"><p>6. ë°¤ì— ì£¼ë¬´ì‹œë‹¤ ëª‡ ë²ˆ ê¹¨ì‹­ë‹ˆê¹Œ?</p><div class="radio-group"><label><input type="radio" name="q6" value="1">0~1ë²ˆ</label><label><input type="radio" name="q6" value="2">2~3ë²ˆ</label><label><input type="radio" name="q6" value="3">4~5ë²ˆ</label><label><input type="radio" name="q6" value="4">ìì£¼ ê¹¸</label></div></div>
                <div class="question"><p>7. ì•„ì¹¨ì— ê°œìš´í•˜ì‹­ë‹ˆê¹Œ?</p><div class="radio-group"><label><input type="radio" name="q7" value="1">í•­ìƒ</label><label><input type="radio" name="q7" value="2">ëŒ€ì²´ë¡œ</label><label><input type="radio" name="q7" value="3">ë³„ë¡œ</label><label><input type="radio" name="q7" value="4">ì „í˜€</label></div></div>
            </div>

            <div class="section"><h2 class="section-title">4. ë§Œì„± ì§ˆí™˜ ë° ê±´ê°• ìƒíƒœ</h2>
                <div class="question"><p>8. ì§„ë‹¨ë°›ì€ ì§ˆí™˜ (ëª¨ë‘ ì„ íƒ)</p><div class="checkbox-group"><label><input type="checkbox" name="q8" value="ê³ í˜ˆì••">ê³ í˜ˆì••</label><label><input type="checkbox" name="q8" value="ë‹¹ë‡¨ë³‘">ë‹¹ë‡¨ë³‘</label><label><input type="checkbox" name="q8" value="ê³ ì§€í˜ˆì¦">ê³ ì§€í˜ˆì¦</label><label><input type="checkbox" name="q8" value="ì‹¬ì¥ì§ˆí™˜">ì‹¬ì¥ì§ˆí™˜</label><label><input type="checkbox" name="q8" value="ë‡Œì¡¸ì¤‘">ë‡Œì¡¸ì¤‘</label></div></div>
                <div class="question"><p>9. (ë‹¹ë‡¨ë³‘ ì‹œ) í˜ˆë‹¹ ê´€ë¦¬ëŠ” ì˜ ë©ë‹ˆê¹Œ?</p><div class="radio-group"><label><input type="radio" name="q9" value="1">ì˜ë¨</label><label><input type="radio" name="q9" value="2">ë³´í†µ</label><label><input type="radio" name="q9" value="3">ì•ˆë¨</label><label><input type="radio" name="q9" value="4">ëª¨ë¦„</label></div></div>
                <div class="question"><p>10. ì‹ ì²´ ê³„ì¸¡</p><div class="input-group"><div><label for="height">í‚¤(cm)</label><input type="number" id="height" name="height"></div><div><label for="weight">ëª¸ë¬´ê²Œ(kg)</label><input type="number" id="weight" name="weight"></div></div><div><label>ì²´ì§ˆëŸ‰ì§€ìˆ˜(BMI):</label><span id="bmi-result">í‚¤ì™€ ëª¸ë¬´ê²Œë¥¼ ì…ë ¥í•˜ì„¸ìš”.</span></div></div>
                <div class="question"><p>11. ì²­ë ¥ ì €í•˜ë¥¼ ëŠë¼ì‹­ë‹ˆê¹Œ?</p><div class="radio-group"><label><input type="radio" name="q11" value="1">ë¬¸ì œì—†ìŒ</label><label><input type="radio" name="q11" value="2">ì¡°ê¸ˆ ë¶ˆí¸</label><label><input type="radio" name="q11" value="3">ëŒ€í™” ì–´ë ¤ì›€</label><label><input type="radio" name="q11" value="4">ë³´ì²­ê¸° ì‚¬ìš©</label><label><input type="radio" name="q11" value="5">ë§¤ìš° ë¶ˆí¸</label></div></div>
            </div>

            <div class="button-container">
                <button type="button" id="submit-btn">ê²°ê³¼ ë¶„ì„ ë° ê²°ê³¼ì§€ ìƒì„±</button>
            </div>
        </form>

        <div id="result-page">
            <div class="result-header">
                <h1>ê¸¸ìŒí•œì˜ì› ì¸ì§€ ê±´ê°• ìŠ¤í¬ë¦¬ë‹ ê²°ê³¼ì§€</h1>
            </div>
            <div class="patient-info">
                <div><strong>í™˜ìì„±ëª…:</strong> <span id="result-name"></span></div>
                <div><strong>ë‚˜ì´:</strong> ë§Œ <span id="result-age"></span>ì„¸</div>
                <div><strong>ê²€ì‚¬ì¼:</strong> <span id="result-date"></span></div>
            </div>
            <div id="result-level-box"></div>
            <div class="result-section">
                <h3>ì£¼ìš” ìœ„í—˜ ìš”ì¸ ë¶„ì„ (í•œì˜í•™ì  ê´€ì )</h3>
                <ul id="risk-factors-list"></ul>
            </div>
             <div class="practitioner-comment">
                <h3>ê¹€ë•í˜¸ ì›ì¥ë‹˜ ì¢…í•© ì†Œê²¬</h3>
                <p>ìœ„ ê²°ê³¼ëŠ” í™˜ìë¶„ì˜ ì£¼ê´€ì  ì‘ë‹µì„ ë°”íƒ•ìœ¼ë¡œ í•œ ì„ ë³„ ê²€ì‚¬ ê²°ê³¼ì´ë©° ì§ˆë³‘ì˜ ì§„ë‹¨ì´ ì•„ë‹™ë‹ˆë‹¤. <br>ì¸ì§€ ê¸°ëŠ¥ ì €í•˜ ë° ì¹˜ë§¤ëŠ” ì¡°ê¸° ë°œê²¬ê³¼ ì˜ˆë°©ì  ê´€ë¦¬ê°€ ë§¤ìš° ì¤‘ìš”í•©ë‹ˆë‹¤. ë³¸ì›ì—ì„œëŠ” í™˜ìë¶„ì˜ ì²´ì§ˆê³¼ ì „ë°˜ì ì¸ ê±´ê°• ìƒíƒœë¥¼ ê³ ë ¤í•œ ë§ì¶¤í˜• ì¹˜ë£Œë¥¼ í†µí•´ ë‡Œ ê±´ê°•ì„ ì¦ì§„ì‹œì¼œ ë“œë¦½ë‹ˆë‹¤.</p>
                <textarea rows="4" style="width: 100%; padding: 10px; font-size: 1em;" placeholder="ì—¬ê¸°ì— ì¶”ê°€ ì†Œê²¬ì„ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
            </div>
            <div class="button-container no-print">
                <button onclick="window.print()" style="margin-right: 15px; background-color: #27ae60;">ğŸ–¨ï¸ ê²°ê³¼ì§€ ì¸ì‡„í•˜ê¸°</button>
                <button onclick="location.reload()">â†©ï¸ ìƒˆ ì„¤ë¬¸ ì‘ì„±í•˜ê¸°</button>
            </div>
        </div>
    </div>

    <script>
        // ì˜¤ëŠ˜ ë‚ ì§œ ìë™ ì„¤ì •
        document.getElementById('today').valueAsDate = new Date();

        // BMI ìë™ ê³„ì‚°
        const heightInput = document.getElementById('height');
        const weightInput = document.getElementById('weight');
        const bmiResult = document.getElementById('bmi-result');
        function calculateBmi() {
            const height = parseFloat(heightInput.value);
            const weight = parseFloat(weightInput.value);
            if (height > 0 && weight > 0) {
                const bmi = weight / ((height / 100) ** 2);
                const bmiValue = bmi.toFixed(2);
                let bmiCategory = bmi < 18.5 ? ' (ì €ì²´ì¤‘)' : bmi < 23 ? ' (ì •ìƒ)' : bmi < 25 ? ' (ê³¼ì²´ì¤‘)' : ' (ë¹„ë§Œ)';
                bmiResult.textContent = `${bmiValue} ${bmiCategory}`;
                bmiResult.dataset.bmi = bmi;
            } else {
                bmiResult.textContent = 'í‚¤ì™€ ëª¸ë¬´ê²Œë¥¼ ì…ë ¥í•˜ì„¸ìš”.';
            }
        }
        heightInput.addEventListener('input', calculateBmi);
        weightInput.addEventListener('input', calculateBmi);
        
        // ==================== [ìŠ¤í¬ë¦½íŠ¸ í•µì‹¬ ìˆ˜ì •] ====================
        document.getElementById('submit-btn').addEventListener('click', function() {
            const form = document.getElementById('cognitive-form');
            const errors = [];

            // --- 1. ì „ì²´ í•„ìˆ˜ í•­ëª© ê²€ì‚¬ ---
            if (!form.elements['name'].value) {
                errors.push('1ë¶€: í™˜ì ì„±ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
            }
            if (!form.elements['birthdate'].value) {
                errors.push('1ë¶€: ìƒë…„ì›”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
            }
            if (!form.elements['gender'].value) {
                errors.push('1ë¶€: ì„±ë³„ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
            }
            for (let i = 1; i <= 4; i++) {
                if (!form.querySelector(`input[name="q${i}"]:checked`)) {
                    errors.push(`2ë¶€: ${i}ë²ˆ ì¸ì§€ ê¸°ëŠ¥ í‰ê°€ ë¬¸í•­ì— ë‹µë³€í•´ì£¼ì„¸ìš”.`);
                }
            }

            // --- 2. ì˜¤ë¥˜ê°€ ìˆìœ¼ë©´ í•œë²ˆì— ëª¨ë‘ ì•Œë ¤ì£¼ê³  ì¤‘ë‹¨ ---
            if (errors.length > 0) {
                alert('ë‹¤ìŒ í•­ëª©ì„ í™•ì¸í•´ì£¼ì„¸ìš”:\n\n- ' + errors.join('\n- '));
                return;
            }

            // --- 3. ëª¨ë“  ê²€ì‚¬ë¥¼ í†µê³¼í•œ ê²½ìš°ì—ë§Œ ê²°ê³¼ ë¶„ì„ ì‹¤í–‰ ---
            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());
            data.q8 = formData.getAll('q8');

            let cognitiveScore = 0;
            for (let i = 1; i <= 4; i++) {
                cognitiveScore += parseInt(data[`q${i}`], 10);
            }

            const riskFactors = [];
            if ((data.q5 && parseInt(data.q5) >= 3) || (data.q6 && parseInt(data.q6) >= 2) || (data.q7 && parseInt(data.q7) >= 3)) {
                riskFactors.push("ìˆ˜ë©´ì˜ ì§ˆ ì €í•˜ (å¿ƒè„¾å‹æ, é™°è™›ç«æ—º): ë‡Œê°€ ì¶©ë¶„íˆ ì‰¬ì§€ ëª»í•˜ì—¬ ë…¸íë¬¼(æ¿•ç—°)ì´ ìŒ“ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
            }
            if (data.q8.length > 0) {
                riskFactors.push(`ë§Œì„± ì§ˆí™˜ (${data.q8.join(', ')}): í˜ˆì•¡ìˆœí™˜ì„ ì €í•´í•˜ì—¬ ë‡Œì— ì¶©ë¶„í•œ ì˜ì–‘ ê³µê¸‰ì„ ë°©í•´í•˜ëŠ” ì–´í˜ˆ(ç˜€è¡€)ì˜ ì›ì¸ì´ ë©ë‹ˆë‹¤.`);
            }
            if (data.q8.includes('ë‹¹ë‡¨ë³‘') && data.q9 && parseInt(data.q9) >= 3) {
                riskFactors.push("ì¡°ì ˆë˜ì§€ ì•ŠëŠ” í˜ˆë‹¹: í˜ˆê´€ ì†ìƒì„ ìœ ë°œí•˜ê³  ì¸ì§€ ê¸°ëŠ¥ ì €í•˜ë¥¼ ê°€ì†í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
            }
            const bmi = parseFloat(bmiResult.dataset.bmi);
            if (bmi >= 23) {
                 riskFactors.push(`ê³¼ì²´ì¤‘/ë¹„ë§Œ (BMI: ${bmi.toFixed(2)}): ì²´ë‚´ ìŠµë‹´(æ¿•ç—°)ì„ ì¡°ì¥í•˜ì—¬ ê¸°í˜ˆ ìˆœí™˜ì„ ë°©í•´í•˜ê³  ë‡Œê¸°ëŠ¥ì— ì˜í–¥ì„ ì¤ë‹ˆë‹¤.`);
            }
            if (data.q11 && parseInt(data.q11) >= 3) {
                riskFactors.push("ì²­ë ¥ ì €í•˜ (è…è™›): ì™¸ë¶€ ìê·¹ ê°ì†ŒëŠ” ì¸ì§€ í™œë™ ì €í•˜ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
            }

            let finalLevel = 1;
            if (cognitiveScore >= 10 || (cognitiveScore >= 8 && riskFactors.length >= 2)) {
                finalLevel = 3;
            } else if (cognitiveScore >= 6 || riskFactors.length >= 1) {
                finalLevel = 2;
            }
            
            const birthDate = new Date(data.birthdate);
            const today = new Date();
            let age = today.getFullYear() - birthDate.getFullYear();
            const m = today.getMonth() - birthDate.getMonth();
            if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) {
                age--;
            }
            document.getElementById('result-name').textContent = data.name;
            document.getElementById('result-age').textContent = age;
            document.getElementById('result-date').textContent = new Date(data.today).toLocaleDateString('ko-KR');

            const levelBox = document.getElementById('result-level-box');
            if(finalLevel === 1) {
                levelBox.className = 'result-box level-1';
                levelBox.innerHTML = '<div class="result-title">ğŸŸ¢ ì–‘í˜¸ (ì´ˆë¡ë¶ˆ)</div><div class="result-subtitle">í˜„ì¬ ì¸ì§€ ê¸°ëŠ¥ ë° ìƒí™œ ìŠµê´€ì´ ê±´ê°•í•˜ê²Œ ìœ ì§€ë˜ê³  ìˆìŠµë‹ˆë‹¤.</div>';
            } else if (finalLevel === 2) {
                levelBox.className = 'result-box level-2';
                levelBox.innerHTML = '<div class="result-title">ğŸŸ¡ ì£¼ì˜ (ë…¸ë€ë¶ˆ)</div><div class="result-subtitle">ê²½ë¯¸í•œ ì¸ì§€ ì €í•˜ ë˜ëŠ” ìœ„í—˜ìš”ì¸ì´ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤. ì˜ˆë°©ì  ê´€ë¦¬ê°€ í•„ìš”í•©ë‹ˆë‹¤.</div>';
            } else {
                levelBox.className = 'result-box level-3';
                levelBox.innerHTML = '<div class="result-title">ğŸ”´ ê²½ê³  (ë¹¨ê°„ë¶ˆ)</div><div class="result-subtitle">ì¸ì§€ ê¸°ëŠ¥ ì €í•˜ê°€ ì˜ì‹¬ë©ë‹ˆë‹¤. ì ê·¹ì ì¸ ê²€ì‚¬ì™€ í•œì˜í•™ì  ì¹˜ë£Œë¥¼ ê¶Œì¥í•©ë‹ˆë‹¤.</div>';
            }

            const riskList = document.getElementById('risk-factors-list');
            riskList.innerHTML = '';
            if (riskFactors.length > 0) {
                riskFactors.forEach(factor => {
                    const li = document.createElement('li');
                    li.textContent = factor;
                    riskList.appendChild(li);
                });
            } else {
                riskList.innerHTML = '<li>íŠ¹ë³„íˆ ë°œê²¬ëœ ìœ„í—˜ ìš”ì¸ì´ ì—†ìŠµë‹ˆë‹¤. ì¢‹ì€ ìŠµê´€ì„ ìœ ì§€í•´ì£¼ì„¸ìš”.</li>';
            }

            document.getElementById('cognitive-form').style.display = 'none';
            document.getElementById('result-page').style.display = 'block';
        });
        // =============================================================
    </script>
</body>
</html>